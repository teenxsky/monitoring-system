groups:
  - name: CriticalAlerts
    rules:
      - alert: ServiceDown
        expr: up == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          description: "üö® Service '{{ $labels.instance }}' is down üö®"
          summary: "–°–µ—Ä–≤–∏—Å '{{ $labels.instance }}' –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –±–æ–ª–µ–µ 1 –º–∏–Ω—É—Ç—ã."

      - alert: ServiceDownLong
        expr: up == 0
        for: 5m
        labels:
          severity: critical
        annotations:
          description: "üö® Service '{{ $labels.instance }}' is down for 5 minutes üö®"
          summary: "–°–µ—Ä–≤–∏—Å '{{ $labels.instance }}' –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç!"

      - alert: DiskSpaceUsageWarning
        expr: 100 - (node_filesystem_avail_bytes{fstype!="tmpfs",fstype!="devtmpfs"} * 100 / node_filesystem_size_bytes{fstype!="tmpfs",fstype!="devtmpfs"}) > 90
        for: 5m
        labels:
          severity: warning
        annotations:
          description: "Disk usage warning on {{ $labels.instance }}"
          summary: "–î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 90%."

      - alert: DiskSpaceUsageCritical
        expr: 100 - (node_filesystem_avail_bytes{fstype!="tmpfs",fstype!="devtmpfs"} * 100 / node_filesystem_size_bytes{fstype!="tmpfs",fstype!="devtmpfs"}) > 95
        for: 1m
        labels:
          severity: critical
        annotations:
          description: "üö® High disk usage: {{ $labels.instance }} üö®"
          summary: "–î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω –Ω–∞ 95%. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏—Å–∫!"

      - alert: DiskInodeUsageCritical
        expr: 100 - (node_filesystem_files_free{fstype!="tmpfs",fstype!="devtmpfs"} * 100 / node_filesystem_files{fstype!="tmpfs",fstype!="devtmpfs"}) > 95
        for: 1m
        labels:
          severity: critical
        annotations:
          description: "üö® High inode usage: {{ $labels.instance }} üö®"
          summary: "Inode –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –Ω–∞ 95%. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏—Å–∫!"

      - alert: CPUUsageWarning
        expr: 100 - (avg by(instance)(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 70
        for: 5m
        labels:
          severity: warning
        annotations:
          description: "CPU usage warning on {{ $labels.instance }}"
          summary: "CPU > 70% –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç."

      - alert: CPUUsageCritical
        expr: 100 - (avg by(instance)(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 85
        for: 5m
        labels:
          severity: critical
        annotations:
          description: "üö® High CPU usage {{ $labels.instance }} üö®"
          summary: "CPU > 85% –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç."

      - alert: RAMUsageWarning
        expr: 100 * (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) > 70
        for: 5m
        labels:
          severity: warning
        annotations:
          description: "RAM usage warning on {{ $labels.instance }}"
          summary: "RAM > 70% –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç."

      - alert: RAMUsageCritical
        expr: 100 * (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) > 85
        for: 1m
        labels:
          severity: critical
        annotations:
          description: "üö® High RAM usage {{ $labels.instance }} üö®"
          summary: "RAM > 85% –±–æ–ª–µ–µ 1 –º–∏–Ω—É—Ç—ã."

      - alert: NetworkErrors
        expr: rate(node_network_receive_errs_total[5m]) > 0 or rate(node_network_transmit_errs_total[5m]) > 0
        for: 2m
        labels:
          severity: warning
        annotations:
          description: "Network errors detected on {{ $labels.instance }}"
          summary: "–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏ —Å–µ—Ç–∏ (receive/transmit errors)."

      - alert: NginxHigh5xxErrorRate
        expr: sum(increase(nginx_http_response_count_total{status=~"5.."}[1m])) > 5
        for: 1m
        labels:
          severity: critical
        annotations:
          description: "üö® –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫ 5xx –Ω–∞ nginx ({{ $value }} –∑–∞ –º–∏–Ω—É—Ç—É) –Ω–∞ {{ $labels.instance }}. üö®"
          summary: "–ë–æ–ª–µ–µ 5 –æ—à–∏–±–æ–∫ 5xx –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–Ω—É—Ç—É."
